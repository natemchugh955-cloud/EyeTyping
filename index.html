<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Eye Controlled Sentence Builder</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin-top: 40px;
      background: #f4f4f4;
    }
    #display {
      font-size: 28px;
      margin: 20px;
      padding: 10px;
      background: white;
      border-radius: 8px;
      display: inline-block;
      min-width: 300px;
    }
    #prediction {
      margin: 20px;
      font-size: 20px;
      color: #333;
    }
    #controls button {
      font-size: 20px;
      margin: 10px;
      padding: 12px 24px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      background: #007bff;
      color: white;
    }
    #controls button:hover {
      background: #0056b3;
    }
  </style>
</head>
<body>
  <h1>Eye Controlled Sentence Builder</h1>
  <div id="display">Current: </div>
  <div id="prediction">Predicted Next Letters: ...</div>
  <div id="controls">
    <button onclick="yes()">YES (Look Up)</button>
    <button onclick="no()">NO (Look Down)</button>
  </div>

  <script>
    let words = [];
    let currentSentence = "";
    let currentWord = "";
    let letterQueue = [];
    let predicting = false;

    // consonant order you gave
    const consonantOrder = ["t","n","s","h","r","d","l","c","m","w",
                            "f","g","y","p","b","v","j","k","x","q","z"];
    const vowels = ["a","e","i","o","u"];

    // Load dictionary
    fetch("words.txt")
      .then(res => res.text())
      .then(text => {
        words = text.split("\n").map(w => w.trim().toLowerCase()).filter(w => w.length > 0);
        console.log("Loaded", words.length, "words");
        startNewWord();
      });

    function startNewWord() {
      currentWord = "";
      letterQueue = ["vowel?"]; // start with vowel question
      predicting = false;
      updateDisplay();
    }

    function updateDisplay() {
      document.getElementById("display").innerText =
        "Current: " + currentSentence + currentWord;

      if (predicting && letterQueue.length > 0) {
        document.getElementById("prediction").innerText =
          "Predicted Next Letters: " + letterQueue.join(", ");
      } else {
        document.getElementById("prediction").innerText =
          "Predicted Next Letters: ...";
      }
    }

    function yes() {
      if (!predicting) {
        // we’re at the start, deciding vowel/consonant
        if (letterQueue[0] === "vowel?") {
          letterQueue = [...vowels];
          predicting = true;
        }
      } else {
        // accept the current choice
        if (letterQueue[0] === "next word?") {
          handleNextWordYes();
        } else {
          acceptLetter(letterQueue[0]);
        }
      }
      updateDisplay();
    }

    function no() {
      if (!predicting) {
        // if not a vowel, move to consonants
        if (letterQueue[0] === "vowel?") {
          letterQueue = [...consonantOrder];
          predicting = true;
        }
      } else {
        if (letterQueue[0] === "next word?") {
          handleNextWordNo();
        } else {
          letterQueue.shift(); // skip current option
        }
      }
      updateDisplay();
    }

    function acceptLetter(letter) {
      currentWord += letter;
      console.log("Accepted:", currentWord);

      // Check if word complete
      if (words.includes(currentWord)) {
        letterQueue = ["next word?"];
        predicting = true;
        return;
      }

      // Predict next letters based on dictionary
      let nextLetters = {};
      words.forEach(w => {
        if (w.startsWith(currentWord) && w.length > currentWord.length) {
          let nextChar = w[currentWord.length];
          nextLetters[nextChar] = (nextLetters[nextChar] || 0) + 1;
        }
      });

      // Sort predictions
      letterQueue = Object.entries(nextLetters)
        .sort((a, b) => b[1] - a[1])
        .map(entry => entry[0]);

      if (letterQueue.length === 0) {
        // dead end → restart
        letterQueue = ["vowel?"];
        predicting = false;
      }
    }

    function handleNextWordYes() {
      currentSentence += currentWord + " ";
      startNewWord();
    }

    function handleNextWordNo() {
      // continue building longer word
      let possible = words.filter(w => w.startsWith(currentWord));
      let nextLetters = {};
      possible.forEach(w => {
        if (w.length > currentWord.length) {
          let nextChar = w[currentWord.length];
          nextLetters[nextChar] = (nextLetters[nextChar] || 0) + 1;
        }
      });
      letterQueue = Object.entries(nextLetters)
        .sort((a, b) => b[1] - a[1])
        .map(entry => entry[0]);

      if (letterQueue.length === 0) {
        letterQueue = ["vowel?"];
        predicting = false;
      }
    }
  </script>
</body>
</html>



