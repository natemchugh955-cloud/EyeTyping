<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Eye Blink Sentence Builder</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; margin-top: 40px; }
    #prompt { font-size: 2em; margin: 20px; }
    #current { font-size: 1.5em; margin-top: 10px; }
    #log { margin-top: 20px; font-size: 1em; color: gray; }
  </style>
</head>
<body>
  <h1>Eye Blink Sentence Builder</h1>
  <div id="prompt">Look up to start</div>
  <div id="current"></div>
  <div id="log"></div>

  <script>
    let words = [];
    let currentWord = "";
    let currentSentence = "";
    let predicting = false;

    // Custom letter orders
    const vowels = ["a", "e", "i", "o", "u"];
    const consonants = ["t","n","s","h","r","d","l","c","m","w","f","g","y","p","b","v","j","k","x","q","z"];

    // Load dictionary
    fetch("words.txt")
      .then(res => res.text())
      .then(text => {
        words = text.split("\n").map(w => w.trim().toLowerCase()).filter(Boolean);
        document.getElementById("log").innerText = `Dictionary loaded: ${words.length} words`;
      })
      .catch(err => {
        console.error(err);
        document.getElementById("log").innerText = "Failed to load words.txt";
      });

    function filterCandidates(prefix) {
      return words.filter(w => w.startsWith(prefix));
    }

    function predictNextLetter(prefix) {
      let candidates = filterCandidates(prefix);
      if (candidates.length === 0) return null;

      let freq = {};
      for (let w of candidates) {
        if (w.length > prefix.length) {
          let next = w[prefix.length];
          freq[next] = (freq[next] || 0) + 1;
        }
      }

      let sorted = Object.entries(freq).sort((a,b) => b[1] - a[1]);
      return sorted.length > 0 ? sorted[0][0] : null;
    }

    function askLetter() {
      if (currentWord === "") {
        document.getElementById("prompt").innerText = "Is it a vowel?";
        return;
      }

      let next = predictNextLetter(currentWord);
      if (next) {
        document.getElementById("prompt").innerText = `Is next letter "${next.toUpperCase()}"?`;
      } else {
        document.getElementById("prompt").innerText = "No predictions. Continue manually.";
      }

      document.getElementById("current").innerText = `Current: ${currentSentence} ${currentWord}`;
    }

    function confirmLetter(letter) {
      currentWord += letter;
      let candidates = filterCandidates(currentWord);

      // If exact word match
      if (candidates.includes(currentWord)) {
        document.getElementById("prompt").innerText = `Word complete: "${currentWord}". Next word?`;
        predicting = true;
      } else {
        askLetter();
      }
    }

    // --- Simulation buttons for testing ---
    document.addEventListener("keydown", e => {
      if (e.key === "Enter") {
        // Reset everything
        currentWord = "";
        currentSentence = "";
        document.getElementById("prompt").innerText = "Is it a vowel?";
      }

      if (e.key === "y") { // YES
        let prompt = document.getElementById("prompt").innerText;

        if (prompt === "Is it a vowel?") {
          document.getElementById("prompt").innerText = `Choose vowel: ${vowels.join(", ")}`;
        }
        else if (prompt.startsWith("Choose vowel")) {
          confirmLetter(vowels[0]); // simplified: always take 'a'
        }
        else if (prompt.startsWith("Is next letter")) {
          let letter = prompt.split('"')[1].toLowerCase();
          confirmLetter(letter);
        }
        else if (prompt.startsWith("Word complete")) {
          // user said YES to next word
          currentSentence += currentWord + " ";
          currentWord = "";
          predicting = false;
          document.getElementById("prompt").innerText = "Is it a vowel?";
        }
      }

      if (e.key === "n") { // NO
        let prompt = document.getElementById("prompt").innerText;

        if (prompt === "Is it a vowel?") {
          document.getElementById("prompt").innerText = `Choose consonant: ${consonants.join(", ")}`;
        }
        else if (prompt.startsWith("Word complete")) {
          // user said NO â†’ keep spelling longer word
          askLetter();
        }
      }
    });
  </script>
</body>
</html>






